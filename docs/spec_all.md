# 音楽アプリケーション MVP フェーズ基本仕様書

**バージョン:** 1.0  
**作成日:** 2025年3月2日  
**対象フェーズ:** フェーズ1（MVP）  

## 1. システム概要

### 1.1 目的

インディーズミュージシャンが事務所を介さず直接収益化できる環境を提供する。MVPフェーズでは、基本的な楽曲のアップロード、再生、および簡易的な収益化機能に焦点を当てる。

### 1.2 対象ユーザー

- **アーティスト:** 事務所に所属せず、自身の楽曲を公開・販売したいミュージシャン
- **リスナー:** インディーズ音楽に関心を持つ一般ユーザー

## 2. MVPフェーズの機能範囲

### 2.1 含まれる機能

- ユーザー登録・認証（アーティスト/リスナー）
- 楽曲のアップロード、管理（アーティスト向け）
- 楽曲の検索、再生（ストリーミング）
- 楽曲の購入・ダウンロード
- シンプルな収益ダッシュボード（アーティスト向け）
- 基本的なプロフィール管理

### 2.2 含まれない機能（将来の拡張）

- ファンクラブ・サブスクリプション
- 高度な分析・統計
- リアルタイム通知
- プレイリスト共有
- モバイルアプリ対応（初期はWebのみ）

## 3. システムアーキテクチャ（MVP版）

### 3.1 全体構成

```[plain]
[クライアント]
    ↓↑
[Webサーバー]
    ↓↑
[アプリケーション層]
    ↓↑
[データベース/ストレージ]
```

### 3.2 技術スタック

- **フロントエンド:** React（Webのみ）
- **バックエンド:** Node.js Express または FastAPI
- **データベース:** MongoDB または PostgreSQL
- **認証:** Firebase Authentication
- **ストレージ:** AWS S3（楽曲ファイル用）
- **決済処理:** Stripe API

## 4. データモデル（MVP版）

### 4.1 ユーザー (users)

```[json]
{
  id: String (PK),
  email: String (unique),
  passwordHash: String,
  displayName: String,
  profileImage: String (URL),
  userType: String (artist/listener),
  createdAt: DateTime,
  updatedAt: DateTime,
  isVerified: Boolean
}
```

### 4.2 楽曲 (tracks)

```[json]
{
  id: String (PK),
  artistId: String (FK),
  title: String,
  description: String,
  genre: String,
  coverArtUrl: String,
  audioFileUrl: String,
  duration: Number (seconds),
  price: Number,
  releaseDate: Date,
  createdAt: DateTime,
  updatedAt: DateTime,
  isPublic: Boolean,
  playCount: Number
}
```

### 4.3 購入 (purchases)

```[json]
{
  id: String (PK),
  userId: String (FK),
  trackId: String (FK),
  amount: Number,
  purchaseDate: DateTime,
  paymentMethod: String,
  transactionId: String
}
```

## 5. 画面設計（MVP版）

### 5.1 主要画面一覧

1. **ランディング/ログイン画面**
   - サービス紹介
   - ログインフォーム
   - 新規登録リンク

2. **ホーム画面**
   - 新着楽曲
   - おすすめアーティスト
   - 再生プレイヤー（下部固定）

3. **検索画面**
   - 楽曲検索フォーム
   - ジャンル別フィルター
   - 検索結果表示

4. **アーティストプロフィール画面**
   - プロフィール情報
   - 公開中の楽曲リスト
   - 購入ボタン

5. **楽曲詳細画面**
   - 楽曲情報（タイトル、ジャンル、説明等）
   - 再生/プレビューボタン
   - 購入ボタン

6. **アーティストダッシュボード**
   - 楽曲アップロードフォーム
   - 楽曲管理（一覧・編集）
   - 簡易収益レポート

## 6. API エンドポイント（MVP版）

### 6.1 認証関連

```[api]
POST   /api/v1/auth/register       # ユーザー登録
POST   /api/v1/auth/login          # ログイン
POST   /api/v1/auth/logout         # ログアウト
GET    /api/v1/auth/me             # 現在のユーザー情報取得
```

### 6.2 ユーザー関連

```[api]
GET    /api/v1/users/{id}          # ユーザープロフィール取得
PUT    /api/v1/users/{id}          # ユーザープロフィール更新
```

### 6.3 楽曲関連

```[api]
GET    /api/v1/tracks              # 楽曲一覧取得
GET    /api/v1/tracks/{id}         # 楽曲詳細取得
POST   /api/v1/tracks              # 楽曲登録 (アーティストのみ)
PUT    /api/v1/tracks/{id}         # 楽曲更新 (所有アーティストのみ)
DELETE /api/v1/tracks/{id}         # 楽曲削除 (所有アーティストのみ)
GET    /api/v1/tracks/search       # 楽曲検索
```

### 6.4 ストリーミング関連

```[api]
GET    /api/v1/stream/{id}         # 楽曲ストリーミング取得
POST   /api/v1/stream/{id}/play    # 再生カウント記録
```

### 6.5 購入関連

```[api]
POST   /api/v1/purchases           # 楽曲購入処理
GET    /api/v1/purchases           # 購入履歴取得
GET    /api/v1/downloads/{id}      # 購入済み楽曲ダウンロード
```

### 6.6 アーティスト収益

```[api]
GET    /api/v1/artists/me/revenue  # 自分の収益情報取得 (アーティストのみ)
```

## 7. ユーザー操作フロー（MVP版）

## 8. セキュリティ設計（MVP版）

### 8.1 認証・認可

- Firebase Authentication を使用した認証
- JWTベースのAPIアクセス管理
- ロールベース権限管理（アーティスト/リスナー）

### 8.2 データ保護

- HTTPS通信の強制
- ユーザーパスワードはハッシュ化して保存
- 楽曲ファイルはS3の署名付きURLで提供

### 8.3 支払い処理

- Stripe APIを使用した安全な決済処理
- 決済情報はシステムに保存せず、Stripeトークンのみ保持

## 9. インフラストラクチャ設計（MVP版）

### 9.1 デプロイメント計画

- **開発環境:** ローカル開発環境
- **テスト環境:** Netlify/Vercel（フロントエンド）、Heroku（バックエンド）
- **本番環境:** AWS（EC2またはLambda + S3 + CloudFront）

### 9.2 リソースプランニング

- 初期は小規模なスペックでスタート
  - Webサーバー: t2.micro EC2インスタンス
  - データベース: 共有DBまたは最小スペックのマネージドDB
  - ストレージ: S3スタンダードストレージ

## 10. データベース設計（MVP版）

## 11. 開発計画（MVP版）

### 11.1 タイムライン

| フェーズ | 期間 | 主なタスク |
|---------|------|-----------|
| 設計 | 2週間 | 要件整理、API設計、DB設計 |
| フロントエンド開発 | 6週間 | UI実装、API連携 |
| バックエンド開発 | 6週間 | API実装、DB連携、S3連携 |
| 決済連携 | 2週間 | Stripe API連携、購入フロー |
| テスト | 2週間 | 動作確認、バグ修正 |
| デプロイ準備 | 2週間 | インフラ整備、本番環境構築 |

### 11.2 マイルストーン

1. 基本的なユーザー認証機能の実装（2週目）
2. 楽曲アップロード・管理機能の実装（6週目）
3. 楽曲再生機能の実装（8週目）
4. 決済・購入機能の実装（12週目）
5. プロダクト全体の統合テスト（14週目）
6. MVP版リリース（16週目）

## 12. テスト計画（MVP版）

### 12.1 テスト範囲

- ユーザー登録・認証フロー
- 楽曲アップロード、編集機能
- 楽曲検索、再生機能
- 購入、決済機能
- ダウンロード機能

### 12.2 テスト方法

- 開発者による手動テスト
- 友人・知人による限定的なユーザーテスト
- 本番環境に近い環境での統合テスト

## 13. 運用計画（MVP版）

### 13.1 モニタリング

- 基本的なサーバー状態監視
- エラーログの収集と分析
- ユーザーフィードバックの収集

### 13.2 バックアップ戦略

- データベースの日次バックアップ
- ユーザーアップロードコンテンツの冗長保存

## 14. 将来の拡張計画

### 14.1 フェーズ1から次のフェーズへの移行

- プレイリスト機能の追加
- ファンクラブ・サブスクリプション機能
- モバイルアプリ対応
- 詳細な分析ダッシュボード

### 14.2 技術的負債の管理

- MVPで簡素化した部分のリファクタリング計画
- スケーリングに向けたアーキテクチャ再設計の評価

---

このMVPフェーズ基本仕様書は、フェーズ1に焦点を当て、限られたリソースで最小限の機能を実現するための設計をまとめています。将来的な拡張を見据えつつも、まずは基本的な楽曲管理、再生、購入機能を実装し、ユーザーからのフィードバックを収集することを優先しています。
